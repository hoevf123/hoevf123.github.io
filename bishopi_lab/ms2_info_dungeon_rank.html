<!DOCTYPE html>

<head>
    <meta charset="utf-8">
    <title>비숍이 실험실</title>
    <link rel="stylesheet" href="common.css">
    <script src="w3-include-html.js"></script>
    <script src="nav-header.js"></script>
    <style>

        /* ms2-boss-rank-list */
        
        .ms2-boss-rank-list { list-style-type: none; padding: 0; margin: 0; }
        .ms2-boss-rank-list li{ list-style-type: none; display: inline-block;}
        .ms2-boss-rank-list li div{position: relative; display: inline-block;}
        .ms2-boss-rank-list li div.div-linkblock-button{min-height:200px; margin:0px; padding:5px; border-radius : 15px; background: #fff8f0; border: 2px solid #ffe49b; box-shadow: 0 2px 8px rgba(255, 124, 72, 0.08); transition: box-shadow 0.2s, border-color 0.2s, background 0.2s;}
        .ms2-boss-rank-list li div.thumbimg{padding:0px; margin:0px}
        .ms2-boss-rank-list li p{ text-align: center;}
        .ms2-boss-rank-list li p.dungeon-require-level{padding:5px; margin:5px; border-radius: 10px;}


        /* link button of ms2-boss-rank (conventional)*/
        .ms2-boss-rank-list li>a div:not(.dungeon-closed) img{ border: 5px solid rgb(255, 124, 72); z-index: 0;}
        .ms2-boss-rank-list li>a div:not(.dungeon-closed) p.mob-level,
        .ms2-boss-rank-list li>a div:not(.dungeon-closed) p.dungeon-require-level{ background-color: rgb(255, 124, 72);}
        .ms2-boss-rank-list li:hover>a div:not(.dungeon-closed) img{ border-color:darkorange;}
        .ms2-boss-rank-list li:hover>a div:not(.dungeon-closed) p.mob-level{ background-color:darkorange;}
        .ms2-boss-rank-list li:hover>a div.div-linkblock-button,
        .ms2-boss-rank-list li > a div.div-linkblock-button:hover {
            background: #ffbf7e;
            border-color: orange;
            box-shadow: 0 4px 16px rgba(255, 124, 72, 0.18);
        }

        /* link button of ms2-boss-rank but its dungeon recording(or open state) is expired */
        .ms2-boss-rank-list li>a div.dungeon-closed img{ border: 5px solid #333333; z-index: 0;}
        .ms2-boss-rank-list li>a div.dungeon-closed p.mob-level,
        .ms2-boss-rank-list li>a div.dungeon-closed p.dungeon-require-level{ background-color: #333333;}
        .ms2-boss-rank-list li:hover>a div.dungeon-closed img{ border-color:red;}
        .ms2-boss-rank-list li:hover>a div.dungeon-closed p.mob-level{ background-color:red;}
        .ms2-boss-rank-list li:hover>a div.div-linkblock-button.dungeon-closed{ background-color:salmon;}

        /* link button of ms2-boss-rank (not have link) */
        .ms2-boss-rank-list li>:not(a) *{filter:brightness(60%);}
        .ms2-boss-rank-list li>:not(a) img{ border: 5px solid darkgray; z-index: 0; }
        .ms2-boss-rank-list li>:not(a) p.mob-level,
        .ms2-boss-rank-list li>:not(a) p.dungeon-require-level{ background-color: darkgray;}
        .ms2-boss-rank-list li:hover>:not(a) img{ border-color:red;}
        .ms2-boss-rank-list li:hover>:not(a) p.mob-level{ background-color:red;}
        .ms2-boss-rank-list li:hover>:not(a) div.div-linkblock-button{background-color:rgb(250, 124, 124);}




        /* link button ingredients decoration */
        .ms2-boss-rank-list li img{ position:inherit; width:120px; height: 120px; background-color: black; border-radius: 15px; margin:0px; padding:0px;}
        .ms2-boss-rank-list li p.dungeon-type,
        .ms2-boss-rank-list li p.mob-level{position:absolute; z-index: 1;}
        .ms2-boss-rank-list li p.dungeon-name,
        .ms2-boss-rank-list li p.mob-name{padding:3px; margin:3px; max-width: 120px; line-break:strict; word-break: keep-all;}
        .ms2-boss-rank-list li p.dungeon-require-level{color:white;}
        .ms2-boss-rank-list li p.mob-level{left:0px; top:0px; margin:0px; padding:5px; border-radius: 15px 0px 5px 0px; color:white;}
        .ms2-boss-rank-list li p.dungeon-type{position: absolute; right: 0px; bottom:0px; padding:2px; border-radius:2px; background-color:magenta; margin:10px;}
        .ms2-boss-rank-list li p.dungeon-type[data-dungeon-type="카오스 레이드"]{ background-color:crimson;}
        .ms2-boss-rank-list li p.dungeon-type[data-dungeon-type="리버스 레이드"]{ background-color:lightpink;}
        .ms2-boss-rank-list li p.dungeon-type[data-dungeon-type="포트리스 럼블"]{ background-color:skyblue;}
        .ms2-boss-rank-list li p.dungeon-type[data-dungeon-type="월드 인베이전"]{ background-color:orange;}
        .ms2-boss-rank-list li p.dungeon-type[data-dungeon-type="아이 오브 라펜타"]{ background-color:mediumorchid;}
        .ms2-boss-rank-list li p.dungeon-type[data-dungeon-type="칠흑의 성전"]{ background-color:crimson;}

        .ms2-boss-rank-list li a * {text-decoration: none; color:black;}

        .ms2-boss-rank-list li::before { display: none !important; content: none !important; }

        .ms2-boss-rank-list li div.div-linkblock-button.dungeon-closed {
            background: #616161;
            border-color: #bbb;
            box-shadow: 0 2px 8px rgba(120,120,120,0.10);
            color: #888;
        }
        .ms2-boss-rank-list li div.div-linkblock-button.dungeon-closed * {
            color: #888 !important;
        }
        .ms2-boss-rank-list li:hover > a div.div-linkblock-button.dungeon-closed,
        .ms2-boss-rank-list li > a div.div-linkblock-button.dungeon-closed:hover {
            background: #ff6767;
            border-color: #ffb0b0;
            box-shadow: 0 4px 16px rgba(120,120,120,0.18);
        }
    </style>
</head>

<body>
    <div w3-include-html="nav-header.html"></div>
    <section>
        <div class="div-content">
            <h1>던전 순위</h1>
            <p>실시간 던전 순위를 볼 수 있는 링크를 모아 둔 곳입니다.</p>
            <h2>실시간으로 확인 가능한 던전 링크</h2>
            <p>※ 링크 클릭 시 메이플스토리2 - 랭킹 - 보스 페이지로 이동됩니다....만 2025년 5월 29일 오전 10시 서비스 종료로 인하여 이동 링크를 비활성화합니다.※</p>
            <ul class="ms2-boss-rank-list"></ul>
            <script type="module">
                import {temp_dungeon_datas} from "./ms2_datawarehouse_dungeon_datas.mjs";
                //Needs at least ES6 Specifications.
                const MAPLESTORY2_BOSSRANK_URL = "https://maplestory2.nexon.com/Rank/Boss3"; //Boss3 = Most Cleared Dungon Person infos
                const MAPLESTORY2_IMAGEPORTRAIT_DIR = "./Maplestory2/Image/portrait/"; // location of MS2 Internal mob ans npc portrait images
                const _DOM_DIV_LINKBLOCK_BUTTON_CLASSNAME = "div-linkblock-button";
                const _DOM_DUNGEONTYPE_CLASSNAME = "dungeon-type";
                const _DOM_DUNGEONNAME_CLASSNAME = "dungeon-name";
                const _DOM_DUNGEONREQUIRELEVEL_CLASSNAME = "dungeon-require-level";
                const _DOM_MONSTERLEVEL_CLASSNAME = "mob-level";
                const _DOM_MONSTERNAME_CLASSNAME = "mob-name";
                const _DOM_DIV_THUMBNAILIMAGE_CLASSNAME = "div-thumbimg";
                const _DOM_DIV_THUMBNAILIMAGE_DUNGEONEXPIRED_CLASSNAME = "dungeon-closed";
                
                let dom_bosslists = Array.from(document.getElementsByClassName("ms2-boss-rank-list")); //many of classes.
                let tmp_datas = temp_dungeon_datas;
                console.log("imported data : ", tmp_datas);
                let new_data_bosslists = tmp_datas.filter((e)=>{
                    return e?.["isRankSearchable"] == true;
                });
                console.log("new data : ", new_data_bosslists);
                let assembled_domElements = new_data_bosslists.reduce((accumulate,link_bossinfo)=>{
                    let [_dom_li, _dom_div, _dom_dungeonType, _dom_dungeonRequireLevel, _dom_dungeonName, _dom_bossLevel, _dom_bossName, _dom_url, _dom_closed, _dom_thumbnailImg, _dom_div_thumbnailImg] = ["li","div", "p","p", "p", "p", "p", "a", "p","img", "div"].map(e=>document.createElement(e));
                    if(link_bossinfo !==undefined && link_bossinfo !== null){
                        let root_DOM = _dom_div;
                        _dom_div.className = _DOM_DIV_LINKBLOCK_BUTTON_CLASSNAME;
                        console.log(link_bossinfo);
                        //prepare string content.
                        let _s_REQUIRE_LEVEL_HEADER = "요구 레벨";
                        let _s_LEVEL_HEADER = "Lv.";
                        let _s_dungeonRequireLevel = `${_s_LEVEL_HEADER} ${new String(link_bossinfo?.["requireLevel"])}`;
                        let _s_requireLevel  = `${_s_REQUIRE_LEVEL_HEADER} ${_s_dungeonRequireLevel}`;
                        let _s_dungeonType = new String(link_bossinfo?.["dungeonType"]);
                        let _s_dungeonName = new String(link_bossinfo?.["dungeonName"]);
                        let _s_bossLevel = `${_s_LEVEL_HEADER} ${new String(link_bossinfo?.["representiveBossMonster"]?.["monsterLevel"])}`;
                        let _s_bossName = new String(link_bossinfo?.["representiveBossMonster"]?.["monsterName"]);
                        let _v_monsterId = link_bossinfo?.["representiveBossMonster"]?.["monsterId"];
                        let _s_title_dungeonName = "["+ _s_dungeonType+"]"+ _s_dungeonName;
                        let _s_thumbnailImg_src = new String(link_bossinfo?.["representiveBossMonster"]?.["thumbnailImage"]);
                        let _s_alt_thumbnailImg = new String(_s_bossLevel +" " + _s_title_dungeonName);
                        let _s_closed = "(Closed)";
                        let _b_dungeon_closed = Boolean(link_bossinfo?.["dungeonClosedDate"]!==undefined?true:false); // DO NOT USE new Boolean if you use it, it treats as Object.
                        let _b_is_dungeon_record_updatable = Boolean(link_bossinfo?.["isRankInfoUpdatable"]);

                        //assemble string to DOM and its DOMs.
                        [
                            //DOM_TEXT_injectTarget, TEXT_CONTENT, CLASSNAME(optional)
                            [_dom_dungeonType, _s_dungeonType, _DOM_DUNGEONTYPE_CLASSNAME],
                            [_dom_dungeonName, _s_dungeonName, _DOM_DUNGEONNAME_CLASSNAME], 
                            [_dom_bossLevel, _s_bossLevel, _DOM_MONSTERLEVEL_CLASSNAME],
                            [_dom_bossName, _s_bossName, _DOM_MONSTERNAME_CLASSNAME],
                            [_dom_dungeonRequireLevel, _s_requireLevel, _DOM_DUNGEONREQUIRELEVEL_CLASSNAME],
                        ].forEach((e)=>{
                            let [_dom_target, _s_dom_text, _s_dom_className] = e;
                            _dom_target.innerText = new String(_s_dom_text);
                            if(_s_dom_className !== undefined) _dom_target.className = new String(_s_dom_className);
                        })
                        _dom_dungeonType.dataset.dungeonType=_s_dungeonType;    //CSS에서 던전 타입을 확인하기 위해 넣는 data property.
                        _dom_thumbnailImg.src = _s_thumbnailImg_src;
                        _dom_thumbnailImg.alt = _s_alt_thumbnailImg;
                        _dom_div_thumbnailImg.className = _DOM_DIV_THUMBNAILIMAGE_CLASSNAME;

                        //append "dungeon expired additional class" when the real dungeon usage is expired(obsoleted from geniue Maplestory 2 Dungeon)
                        _dom_div.className += _b_dungeon_closed || !_b_is_dungeon_record_updatable ? " "+ _DOM_DIV_THUMBNAILIMAGE_DUNGEONEXPIRED_CLASSNAME:""; //dungeon closed 상태 추가

                        //assemble "text injected" DOMs.
                        [_dom_bossLevel, _dom_dungeonType, _dom_thumbnailImg].forEach(e=>_dom_div_thumbnailImg.appendChild(e));
                        [_dom_dungeonRequireLevel, _dom_div_thumbnailImg, _dom_dungeonName, _dom_bossName].forEach((e)=>_dom_div.appendChild(e));

                        //wrap link to div block.
                        if(!(_v_monsterId == undefined)){
                            //_dom_url.href = MAPLESTORY2_BOSSRANK_URL + "?" + "b=" + new String(_v_monsterId); //inactivated by Maplestory2 Service Termination at 2025.05.29 10:00 AM
                            _dom_url.dataset.obsoleted_href = MAPLESTORY2_BOSSRANK_URL + "?" + "b=" + new String(_v_monsterId);
                            _dom_url.appendChild(_dom_div);
                            root_DOM = _dom_url;
                        }

                        //attatch div(or wraped link) block to li Element.
                        _dom_li.appendChild(root_DOM);
                        return accumulate.concat(_dom_li);
                    }
                   else return accumulate;
                }, []);
                console.log(assembled_domElements);
                dom_bosslists.forEach((e)=>{
                    console.log("hi", assembled_domElements)
                    assembled_domElements.forEach((e_li)=>{e.appendChild(e_li)})
                });
            </script>
            
        </div>
    </section>
</body>